#ifndef CLTLS_HEADER_H_
#define CLTLS_HEADER_H_

#include <stdint.h>

#define MSG_TYPE_CLIENT_HELLO 0x00
#define MSG_TYPE_SERVER_HELLO 0x01
#define MSG_TYPE_SERVER_PUBKEY 0x02
#define MSG_TYPE_SERVER_PUBKEY_VERIFY 0x03
#define MSG_TYPE_SERVER_HANDSHAKE_FINISHED 0x04
#define MSG_TYPE_CLIENT_HANDSHAKE_FINISHED 0x05
#define MSG_TYPE_APPLICATION_DATA 0x06
#define MSG_TYPE_ERROR_STOP_NOTIFY 0xFF

// Key Negotiation and Digital Signature schemes are fixed
// in CL-TLS(X25519 and ED25519); 
// only Encryption and Hash schemes can be specified

#define CIPHER_ASCON128A_ASCONHASHA256 0x00
#define CIPHER_ASCON128A_SHA256 0x01
#define CIPHER_AES128GCM_ASCONHASHA256 0x10
#define CIPHER_AES128GCM_SHA256 0x11

/******************************************************
 * Client Hello
 *
 * ---------------------------------------
 * | Message Type                        |  1B
 * ---------------------------------------
 * | Remaining Length                    |  2B
 * ---------------------------------------
 * | Application Layer Protocol          |  1B
 * ---------------------------------------
 * | Cipher Suite Count                  |  1B
 * ---------------------------------------
 * | Cipher Suites                       |  (1*Count)B
 * ---------------------------------------
 * | Client KE Public Key                |  32B
 * ---------------------------------------
 * | Client KE Random                    |  32B
 * ---------------------------------------
 *
 ******************************************************/

/******************************************************
 * Server Hello
 *
 * ---------------------------------------
 * | Message Type                        |  1B
 * ---------------------------------------
 * | Remaining Length                    |  2B
 * ---------------------------------------
 * | Selected Cipher Suite               |  1B
 * ---------------------------------------
 * | Server KE Public Key                |  32B
 * ---------------------------------------
 * | Server KE Random                    |  32B
 * ---------------------------------------
 *
 ******************************************************/

/******************************************************
 * Server Pubkey
 *
 * ---------------------------------------
 * | Message Type                        |  1B
 * ---------------------------------------
 * | Remaining Length                    |  2B
 * ---------------------------------------
 * | |------------------------------|    | (Encrypted)
 * | | Server Public Key Length     | 2B |
 * | |------------------------------|    |
 * | | Server Public Key            |    |
 * | |------------------------------|    |
 * ---------------------------------------
 *
 ******************************************************/

/******************************************************
 * Server Pubkey Verify
 *
 * ---------------------------------------
 * | Message Type                        |  1B
 * ---------------------------------------
 * | Remaining Length                    |  2B
 * ---------------------------------------
 * | |------------------------------|    | (Encrypted)
 * | | Traffic Signature Length     | 2B |
 * | |------------------------------|    |
 * | | Traffic Signature            |    |
 * | |------------------------------|    |
 * ---------------------------------------
 *
 ******************************************************/

/******************************************************
 * Server Handshake Finished
 *
 * ---------------------------------------
 * | Message Type                        |  1B
 * ---------------------------------------
 * | Remaining Length                    |  2B
 * ---------------------------------------
 * | |------------------------------|    | (Encrypted)
 * | | Traffic Hash Length          | 2B |
 * | |------------------------------|    |
 * | | Traffic Hash                 |    |
 * | |------------------------------|    |
 * ---------------------------------------
 *
 ******************************************************/

/******************************************************
 * Client Handshake Finished
 *
 * ---------------------------------------
 * | Message Type                        |  1B
 * ---------------------------------------
 * | Remaining Length                    |  2B
 * ---------------------------------------
 * | |------------------------------|    | (Encrypted)
 * | | Traffic Hash Length          | 2B |
 * | |------------------------------|    |
 * | | Traffic Hash                 |    |
 * | |------------------------------|    |
 * ---------------------------------------
 *
 ******************************************************/

/******************************************************
 * Application Data
 *
 * ---------------------------------------
 * | Message Type                        |  1B
 * ---------------------------------------
 * | Remaining Length                    |  2B
 * ---------------------------------------
 * | |------------------------------|    | (Encrypted)
 * | | Application Data             |    |
 * | |------------------------------|    |
 * ---------------------------------------
 *
 ******************************************************/

/******************************************************
 * Error Stop Notify
 *
 * ---------------------------------------
 * | Message Type                        |  1B
 * ---------------------------------------
 * | Remaining Length(0)                 |  2B
 * ---------------------------------------
 *
 ******************************************************/

#endif